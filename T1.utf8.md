
<!-- rnb-text-begin -->

---
title: "Trabalho 1 - Aprendizado de Máquina"
output: html_notebook
---


<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxubGlicmFyeShkYXRhLnRyZWUpXG5jb21wdXRlRW50cm9weSA8LSBmdW5jdGlvbihkYXRhLCBhdHRJbmRleD1OVUxMLCBjbGFzc0luZGV4KSB7XG4gICAgI2NsYXNzZXMgbm8gcHJvYmxlbWEgXG4gICAgY2xhc3NlcyA8LSB1bmlxdWUoZGF0YVssY2xhc3NJbmRleF0pXG4gICAgXG4gICAgI3NlIGF0dEluZGV4IG5hbyBmb3IgaW5mb3JtYWRvLCBjYWxjdWxhIGEgZW50cm9waWEgKEluZm8oRCkpIHBhcmEgbyBjb25qdW50byBkZSBkYWRvcyBpbnRlaXJvXG4gICAgaWYgKGlzLm51bGwoYXR0SW5kZXgpKSB7XG4gICAgICAgICNhIHByaW9yaSBlbnRyb3B5XG4gICAgICAgIFxuICAgICAgICBlbnRyb3B5PC0wXG4gICAgICAgIGZvciAoaWkgaW4gMTpsZW5ndGgoY2xhc3Nlcykpe1xuICAgICAgICAgICAgdGVtcDwtIGxlbmd0aCh3aGljaChkYXRhW1tjbGFzc0luZGV4XV0gPT0gY2xhc3Nlc1tpaV0pKVxuICAgICAgICAgICAgcHJvYiA8LSB0ZW1wL2RpbShkYXRhKVsxXVxuICAgICAgICAgICAgZW50cm9weSA8LSBlbnRyb3B5ICsgKC0ocHJvYipsb2cyKHByb2IpKSlcbiAgICAgICAgfVxuICAgIH0gZWxzZXtcbiAgICAgICAgI2Nhc28gY29udHLDoXJpbywgY2FsY3VsYSBhIGVudHJvcGlhIHJlc3RyaXRhIGEgdW0gc3ViY29uanVudG8gZGUgZGFkb3MgXG4gICAgICAgICMgKGFww7NzIHBhcnRpY2FvIHBvciB2YWxvciAndicgZG8gYXRyaWJ1dG8gJ0EnKVxuICAgICAgICBpZihpcy5udW1lcmljKGRhdGFbLCBhdHRJbmRleF0pKVxuICAgICAgICB7XG4gICAgICAgICAgdmFsdWVzIDwtIDJcbiAgICAgICAgICBlbnRyb3B5IDwtIDBcbiAgICAgICAgICB0ZW1wMSA8LSBsZW5ndGgod2hpY2goZGF0YVssYXR0SW5kZXhdID4gbWVhbihkYXRhWyxhdHRJbmRleF0pKSlcbiAgICAgICAgICBwcm9iMSA8LSB0ZW1wMS9kaW0oZGF0YSlbMV1cbiAgICAgICAgICBkYXRhLnN1YnNldCA8LSBkYXRhW3doaWNoKGRhdGFbLGF0dEluZGV4XSA+IG1lYW4oZGF0YVssYXR0SW5kZXhdKSksXVxuICAgICAgICAgIHNvbWEgPC0gMFxuICAgICAgICAgIGZvcihpaSBpbiAxOmxlbmd0aChjbGFzc2VzKSl7XG4gICAgICAgICAgICB0ZW1wIDwtIGxlbmd0aCh3aGljaChkYXRhLnN1YnNldFssY2xhc3NJbmRleF0gPT0gY2xhc3Nlc1tpaV0pKVxuICAgICAgICAgICAgaWYodGVtcCA+IDApe1xuICAgICAgICAgICAgICBwcm9iIDwtIHRlbXAvZGltKGRhdGEuc3Vic2V0KVsxXVxuICAgICAgICAgICAgICBzb21hIDwtIHNvbWErKC0ocHJvYipsb2cyKHByb2IpKSlcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICBzb21hIDwtIHNvbWErMFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBlbnRyb3B5IDwtIGVudHJvcHkgKyAocHJvYjEqc29tYSlcbiAgICAgICAgICBcbiAgICAgICAgICB0ZW1wMSA8LSBsZW5ndGgod2hpY2goZGF0YVssYXR0SW5kZXhdIDw9IG1lYW4oZGF0YVssYXR0SW5kZXhdKSkpXG4gICAgICAgICAgcHJvYjEgPC0gdGVtcDEvZGltKGRhdGEpWzFdXG4gICAgICAgICAgZGF0YS5zdWJzZXQgPC0gZGF0YVt3aGljaChkYXRhWyxhdHRJbmRleF0gPD0gbWVhbihkYXRhWyxhdHRJbmRleF0pKSxdXG4gICAgICAgICAgc29tYSA8LSAwXG4gICAgICAgICAgZm9yKGlpIGluIDE6bGVuZ3RoKGNsYXNzZXMpKXtcbiAgICAgICAgICAgIHRlbXAgPC0gbGVuZ3RoKHdoaWNoKGRhdGEuc3Vic2V0WyxjbGFzc0luZGV4XSA9PSBjbGFzc2VzW2lpXSkpXG4gICAgICAgICAgICBpZih0ZW1wID4gMCl7XG4gICAgICAgICAgICAgIHByb2IgPC0gdGVtcC9kaW0oZGF0YS5zdWJzZXQpWzFdXG4gICAgICAgICAgICAgIHNvbWEgPC0gc29tYSsoLShwcm9iKmxvZzIocHJvYikpKVxuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgIHNvbWEgPC0gc29tYSswXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGVudHJvcHkgPC0gZW50cm9weSArIChwcm9iMSpzb21hKVxuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgdmFsdWVzPC0gdW5pcXVlKGRhdGFbLGF0dEluZGV4XSlcbiAgICAgICAgICBlbnRyb3B5PC0wXG4gICAgICAgICAgZm9yIChqaiBpbiAxOmxlbmd0aCh2YWx1ZXMpKSB7XG4gICAgICAgICAgICAgIHRlbXAxIDwtIGxlbmd0aCh3aGljaChkYXRhWyxhdHRJbmRleF0gPT12YWx1ZXNbampdKSkgXG4gICAgICAgICAgICAgIHByb2IxIDwtIHRlbXAxL2RpbShkYXRhKVsxXVxuICAgICAgICAgICAgICBkYXRhLnN1YnNldCA8LSBkYXRhW3doaWNoKGRhdGFbLGF0dEluZGV4XSA9PXZhbHVlc1tqal0pLF1cbiAgICAgICAgICAgICAgc29tYTwtMFxuICAgICAgICAgICAgICBmb3IgKGlpIGluIDE6bGVuZ3RoKGNsYXNzZXMpKXtcbiAgICAgICAgICAgICAgICAgIHRlbXA8LSBsZW5ndGgod2hpY2goZGF0YS5zdWJzZXRbLGNsYXNzSW5kZXhdPT1jbGFzc2VzW2lpXSkpXG4gICAgICAgICAgICAgICAgICBpZih0ZW1wID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgcHJvYiA8LSB0ZW1wL2RpbShkYXRhLnN1YnNldClbMV1cbiAgICAgICAgICAgICAgICAgICAgICBzb21hIDwtIHNvbWErKC0ocHJvYipsb2cyKHByb2IpKSlcbiAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgIHNvbWEgPC0gc29tYSswXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZW50cm9weSA8LSBlbnRyb3B5ICsgKHByb2IxKnNvbWEpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICBlbnRyb3B5XG4gICAgfSAgXG5gYGAifQ== -->

```r
library(data.tree)
computeEntropy <- function(data, attIndex=NULL, classIndex) {
    #classes no problema 
    classes <- unique(data[,classIndex])
    
    #se attIndex nao for informado, calcula a entropia (Info(D)) para o conjunto de dados inteiro
    if (is.null(attIndex)) {
        #a priori entropy
        
        entropy<-0
        for (ii in 1:length(classes)){
            temp<- length(which(data[[classIndex]] == classes[ii]))
            prob <- temp/dim(data)[1]
            entropy <- entropy + (-(prob*log2(prob)))
        }
    } else{
        #caso contrário, calcula a entropia restrita a um subconjunto de dados 
        # (após particao por valor 'v' do atributo 'A')
        if(is.numeric(data[, attIndex]))
        {
          values <- 2
          entropy <- 0
          temp1 <- length(which(data[,attIndex] > mean(data[,attIndex])))
          prob1 <- temp1/dim(data)[1]
          data.subset <- data[which(data[,attIndex] > mean(data[,attIndex])),]
          soma <- 0
          for(ii in 1:length(classes)){
            temp <- length(which(data.subset[,classIndex] == classes[ii]))
            if(temp > 0){
              prob <- temp/dim(data.subset)[1]
              soma <- soma+(-(prob*log2(prob)))
            }else{
              soma <- soma+0
            }
          }
          entropy <- entropy + (prob1*soma)
          
          temp1 <- length(which(data[,attIndex] <= mean(data[,attIndex])))
          prob1 <- temp1/dim(data)[1]
          data.subset <- data[which(data[,attIndex] <= mean(data[,attIndex])),]
          soma <- 0
          for(ii in 1:length(classes)){
            temp <- length(which(data.subset[,classIndex] == classes[ii]))
            if(temp > 0){
              prob <- temp/dim(data.subset)[1]
              soma <- soma+(-(prob*log2(prob)))
            }else{
              soma <- soma+0
            }
          }
          entropy <- entropy + (prob1*soma)
        }
        else{
          values<- unique(data[,attIndex])
          entropy<-0
          for (jj in 1:length(values)) {
              temp1 <- length(which(data[,attIndex] ==values[jj])) 
              prob1 <- temp1/dim(data)[1]
              data.subset <- data[which(data[,attIndex] ==values[jj]),]
              soma<-0
              for (ii in 1:length(classes)){
                  temp<- length(which(data.subset[,classIndex]==classes[ii]))
                  if(temp > 0){
                      prob <- temp/dim(data.subset)[1]
                      soma <- soma+(-(prob*log2(prob)))
                  }else{
                      soma <- soma+0
                  }
              }
              entropy <- entropy + (prob1*soma)
          }
        }
    }
  entropy
    }  
```

<!-- rnb-source-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxucmFuZG9tQXR0ciA8LSBmdW5jdGlvbihkYXRhKXtcbiAgY29sSWQgPC0gc2FtcGxlKDE6bmNvbChkYXRhKSwgcm91bmQoc3FydChuY29sKGRhdGEpKSksIHJlcGxhY2U9RkFMU0UpXG4gICNwcmludChjb2xJZClcbiAgcmV0dXJuKGNvbElkKVxufVxuYGBgIn0= -->

```r
randomAttr <- function(data){
  colId <- sample(1:ncol(data), round(sqrt(ncol(data))), replace=FALSE)
  #print(colId)
  return(colId)
}
```

<!-- rnb-source-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuY29tcHV0ZVRyZWUgPC0gZnVuY3Rpb24odHJlZSwgZGF0YSwgaW5kZXhDbGFzcyl7XG4gIHJhbmRvbUF0dCA8LSByYW5kb21BdHRyKGRhdGFbLWluZGV4Q2xhc3NdKVxuICAjcHJpbnQocmFuZG9tQXR0KVxuICBlbnRyb3B5Q2xhc3MgPC0gY29tcHV0ZUVudHJvcHkoZGF0YSwgTlVMTCwgaW5kZXhDbGFzcylcbiAgZW50cm9waWVzIDwtIG51bWVyaWMobmNvbChkYXRhKS0xKVxuICBmb3IoaSBpbiAxOmxlbmd0aChyYW5kb21BdHQpKXtcbiAgICBlbnRyb3BpZXNbcmFuZG9tQXR0W2ldXSA8LSBlbnRyb3B5Q2xhc3MgLSBjb21wdXRlRW50cm9weShkYXRhLCBhdHRJbmRleCA9IHJhbmRvbUF0dFtpXSwgaW5kZXhDbGFzcylcbiAgfVxuICBtYXhHYWluIDwtIHdoaWNoLm1heChlbnRyb3BpZXMpXG4gICNwcmludChtYXhHYWluKVxuICBpZighaXMubnVtZXJpYyhkYXRhW1ttYXhHYWluXV0pKXtcbiAgICB0ZXN0IDwtIHVuaXF1ZShkYXRhW21heEdhaW5dKVxuICAgIGVudHJvcGllcyA8LSBOVUxMXG4gICAgZW50cm9waWVzIDwtIG51bWVyaWMobnJvdyh0ZXN0KSlcbiAgfVxuICBcbiAgc3ViRGF0YSA8LSBsaXN0KClcbiAgaWYoaXMubnVtZXJpYyhkYXRhW1ttYXhHYWluXV0pKXtcbiAgICBpZihsZW5ndGgodW5pcXVlKGRhdGFbW21heEdhaW5dXSkpID09IDEpe1xuICAgICAgI3ByaW50KHVuaXF1ZShkYXRhW1ttYXhHYWluXV0pKVxuICAgICAgI3ByaW50KFwidGVzdGUxXCIpXG4gICAgICAjcHJpbnQobmFtZXMod2hpY2gubWF4KHRhYmxlKGRhdGFbLGluZGV4Q2xhc3NdKSkpKVxuICAgICAgI3ByaW50KGRhdGEpXG4gICAgICBcbiAgICAgIFxuICAgICAgaWYobGVuZ3RoKHVuaXF1ZSh0YWJsZShkYXRhWyxpbmRleENsYXNzXSkpKSA9PSAxKXtcbiAgICAgICAgI3ByaW50KHVuaXF1ZShkYXRhWyxpbmRleENsYXNzXSlbc2FtcGxlKDE6MiwgMSldKVxuICAgICAgICAjcHJpbnQoZGF0YSlcbiAgICAgICAgdHJlZSA8LSB0cmVlJEFkZENoaWxkKHVuaXF1ZShkYXRhWyxpbmRleENsYXNzXSlbc2FtcGxlKDE6MiwgMSldKVxuICAgICAgfSBlbHNlIHtcbiAgICAgIHRyZWUgPC0gdHJlZSRBZGRDaGlsZChuYW1lcyh3aGljaC5tYXgodGFibGUoZGF0YVssaW5kZXhDbGFzc10pKSkpXG4gICAgICB9XG4gICAgICBcbiAgICB9IGVsc2Uge1xuICAgICAgI3ByaW50KFwidGVzdGUyXCIpXG4gICAgdHJlZSAgPC0gdHJlZSRBZGRDaGlsZChjb2xuYW1lcyhkYXRhKVttYXhHYWluXSlcbiAgICBmb3IoaSBpbiAxOjIpe1xuICAgICAgaWYoaSA9PSAxKXtcbiAgICAgICAgY2hpbGQgPC0gdHJlZSRBZGRDaGlsZChwYXN0ZShcIjw9XCIsIG1lYW4oZGF0YVssbWF4R2Fpbl0pKSlcbiAgICAgICAgc3ViRGF0YVtbaV1dIDwtIGRhdGFbd2hpY2goZGF0YVssbWF4R2Fpbl0gPD0gbWVhbihkYXRhWyxtYXhHYWluXSkpLF1cbiAgICAgIH0gXG4gICAgICBlbHNlIHsgXG4gICAgICAgIGNoaWxkIDwtIHRyZWUkQWRkQ2hpbGQocGFzdGUoXCI+XCIsIG1lYW4oZGF0YVssbWF4R2Fpbl0pKSkgXG4gICAgICAgIHN1YkRhdGFbW2ldXSA8LSBkYXRhW3doaWNoKGRhdGFbLG1heEdhaW5dID4gbWVhbihkYXRhWyxtYXhHYWluXSkpLF1cbiAgICAgICAgfVxuICAgIGlmKGxlbmd0aCh1bmlxdWUoc3ViRGF0YVtbaV1dWyxpbmRleENsYXNzXSkpID4gMSl7XG4gICAgICBjaGlsZCA8LSBjb21wdXRlVHJlZShjaGlsZCwgc3ViRGF0YVtbaV1dLCBpbmRleENsYXNzKVxuICAgIH0gXG4gICAgZWxzZSBpZihsZW5ndGgodW5pcXVlKHN1YkRhdGFbW2ldXVssaW5kZXhDbGFzc10pKSl7XG4gICAgICAjcHJpbnQobGVuZ3RoKHVuaXF1ZShzdWJEYXRhW1tpXV1bLGluZGV4Q2xhc3NdKSkpXG4gICAgICBjaGlsZCRBZGRDaGlsZCh1bmlxdWUoc3ViRGF0YVtbaV1dWyxpbmRleENsYXNzXSkpXG4gICAgfVxuICAgIH1cbiAgICB9XG4gIH1cbiAgZWxzZXtcbiAgICB0cmVlICA8LSB0cmVlJEFkZENoaWxkKGNvbG5hbWVzKGRhdGEpW21heEdhaW5dKVxuICAgIGZvcihpIGluIDE6KG5yb3codGVzdCkpKXtcbiAgICAgIGNoaWxkIDwtIHRyZWUkQWRkQ2hpbGQodGVzdFtbMV1dW2ldKVxuICAgICAgc3ViRGF0YVtbaV1dIDwtIGRhdGFbd2hpY2goZGF0YVtbbWF4R2Fpbl1dPT10ZXN0W1sxXV1baV0pLF1cbiAgICAgIGlmKGxlbmd0aCh1bmlxdWUoc3ViRGF0YVtbaV1dWyxpbmRleENsYXNzXSkpID4gMSl7XG4gICAgICAgIHN1YkRhdGFbW2ldXSA8LSBjb21wdXRlVHJlZShjaGlsZCwgc3ViRGF0YVtbaV1dLCBpbmRleENsYXNzKVxuICAgICAgfSBlbHNlIGlmKGxlbmd0aCh1bmlxdWUoc3ViRGF0YVtbaV1dWyxpbmRleENsYXNzXSkpID4gMCl7XG4gICAgICAgICNwcmludChsZW5ndGgodW5pcXVlKHN1YkRhdGFbW2ldXVssaW5kZXhDbGFzc10pKSlcbiAgICAgICAgY2hpbGQkQWRkQ2hpbGQodW5pcXVlKHN1YkRhdGFbW2ldXVssaW5kZXhDbGFzc10pKVxuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4odHJlZSlcbn1cbmBgYCJ9 -->

```r
computeTree <- function(tree, data, indexClass){
  randomAtt <- randomAttr(data[-indexClass])
  #print(randomAtt)
  entropyClass <- computeEntropy(data, NULL, indexClass)
  entropies <- numeric(ncol(data)-1)
  for(i in 1:length(randomAtt)){
    entropies[randomAtt[i]] <- entropyClass - computeEntropy(data, attIndex = randomAtt[i], indexClass)
  }
  maxGain <- which.max(entropies)
  #print(maxGain)
  if(!is.numeric(data[[maxGain]])){
    test <- unique(data[maxGain])
    entropies <- NULL
    entropies <- numeric(nrow(test))
  }
  
  subData <- list()
  if(is.numeric(data[[maxGain]])){
    if(length(unique(data[[maxGain]])) == 1){
      #print(unique(data[[maxGain]]))
      #print("teste1")
      #print(names(which.max(table(data[,indexClass]))))
      #print(data)
      
      
      if(length(unique(table(data[,indexClass]))) == 1){
        #print(unique(data[,indexClass])[sample(1:2, 1)])
        #print(data)
        tree <- tree$AddChild(unique(data[,indexClass])[sample(1:2, 1)])
      } else {
      tree <- tree$AddChild(names(which.max(table(data[,indexClass]))))
      }
      
    } else {
      #print("teste2")
    tree  <- tree$AddChild(colnames(data)[maxGain])
    for(i in 1:2){
      if(i == 1){
        child <- tree$AddChild(paste("<=", mean(data[,maxGain])))
        subData[[i]] <- data[which(data[,maxGain] <= mean(data[,maxGain])),]
      } 
      else { 
        child <- tree$AddChild(paste(">", mean(data[,maxGain]))) 
        subData[[i]] <- data[which(data[,maxGain] > mean(data[,maxGain])),]
        }
    if(length(unique(subData[[i]][,indexClass])) > 1){
      child <- computeTree(child, subData[[i]], indexClass)
    } 
    else if(length(unique(subData[[i]][,indexClass]))){
      #print(length(unique(subData[[i]][,indexClass])))
      child$AddChild(unique(subData[[i]][,indexClass]))
    }
    }
    }
  }
  else{
    tree  <- tree$AddChild(colnames(data)[maxGain])
    for(i in 1:(nrow(test))){
      child <- tree$AddChild(test[[1]][i])
      subData[[i]] <- data[which(data[[maxGain]]==test[[1]][i]),]
      if(length(unique(subData[[i]][,indexClass])) > 1){
        subData[[i]] <- computeTree(child, subData[[i]], indexClass)
      } else if(length(unique(subData[[i]][,indexClass])) > 0){
        #print(length(unique(subData[[i]][,indexClass])))
        child$AddChild(unique(subData[[i]][,indexClass]))
      }
    }
  }
  return(tree)
}
```

<!-- rnb-source-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxud2Fsa1RyZWUgPC0gZnVuY3Rpb24odHJlZSwgdGVzdERhdGEpe1xuICBpZihpc0xlYWYodHJlZSkpe1xuICAgIHJldHVybih0cmVlJG5hbWUpXG4gICAgfVxuICAgIGVsc2V7XG4gIGF0dHJpYnV0ZSA8LSBncmVwKHBhc3RlKFwiXFxcXGJcIix0cmVlJG5hbWUsXCJcXFxcYlwiLHNlcD1cIlwiKSwgY29sbmFtZXModGVzdERhdGEpKVxuICAjcHJpbnQoYXR0cmlidXRlKVxuICBpZihpcy5udW1lcmljKHRlc3REYXRhW1thdHRyaWJ1dGVdXSkpe1xuICAgIGF0dEF2ZyA8LSBzdWJzdHJpbmcodHJlZSRjaGlsZHJlbltbMV1dJG5hbWUsIDQpXG4gICAgaWYodGVzdERhdGFbW2F0dHJpYnV0ZV1dID4gYXMubnVtZXJpYyhhdHRBdmcpKXtcbiAgICAgIHdhbGtUcmVlKHRyZWUkY2hpbGRyZW5bWzJdXSRjaGlsZHJlbltbMV1dLCB0ZXN0RGF0YSlcbiAgICB9IGVsc2Uge1xuICAgICAgd2Fsa1RyZWUodHJlZSRjaGlsZHJlbltbMV1dJGNoaWxkcmVuW1sxXV0sIHRlc3REYXRhKVxuICAgIH1cbiAgfSBcbiAgZWxzZSB7XG4gICAgZm9yKGkgaW4gMTp0cmVlJGNvdW50KXtcbiAgICAgIGlmKGlkZW50aWNhbCh0ZXN0RGF0YVtbYXR0cmlidXRlXV0sdHJlZSRjaGlsZHJlbltbaV1dJG5hbWUpKXtcbiAgICAgICAgcmV0dXJuKHdhbGtUcmVlKHRyZWUkY2hpbGRyZW5bW2ldXSRjaGlsZHJlbltbMV1dLCB0ZXN0RGF0YSkpXG4gICAgICB9XG4gICAgfVxuICB9XG4gICAgfVxufVxuYGBgIn0= -->

```r
walkTree <- function(tree, testData){
  if(isLeaf(tree)){
    return(tree$name)
    }
    else{
  attribute <- grep(paste("\\b",tree$name,"\\b",sep=""), colnames(testData))
  #print(attribute)
  if(is.numeric(testData[[attribute]])){
    attAvg <- substring(tree$children[[1]]$name, 4)
    if(testData[[attribute]] > as.numeric(attAvg)){
      walkTree(tree$children[[2]]$children[[1]], testData)
    } else {
      walkTree(tree$children[[1]]$children[[1]], testData)
    }
  } 
  else {
    for(i in 1:tree$count){
      if(identical(testData[[attribute]],tree$children[[i]]$name)){
        return(walkTree(tree$children[[i]]$children[[1]], testData))
      }
    }
  }
    }
}
```

<!-- rnb-source-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuYm9vdHN0cmFwaW5nIDwtIGZ1bmN0aW9uKGRhdGEsIGluZGV4Q2xhc3Mpe1xuICBic0lkIDwtIHNhbXBsZSgxOm5yb3coZGF0YSksIG5yb3coZGF0YSksIHJlcGxhY2U9VFJVRSlcbiAgdHJhaW5EYXRhIDwtIGRhdGFbYnNJZCxdXG4gIFxuICB0cmVlIDwtIE5vZGUkbmV3KFwiUk9PVFwiKVxuICB0cmVlIDwtIGNvbXB1dGVUcmVlKHRyZWUsIHRyYWluRGF0YSwgaW5kZXhDbGFzcylcbiAgXG4gIHJldHVybih0cmVlKVxufVxuYGBgIn0= -->

```r
bootstraping <- function(data, indexClass){
  bsId <- sample(1:nrow(data), nrow(data), replace=TRUE)
  trainData <- data[bsId,]
  
  tree <- Node$new("ROOT")
  tree <- computeTree(tree, trainData, indexClass)
  
  return(tree)
}
```

<!-- rnb-source-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuZW5zZW1ibGUgPC0gZnVuY3Rpb24oZGF0YSwgaW5kZXhDbGFzcywgblRyZWVzKXtcbiAgcmFuZG9tVHJlZXMgPC0gbGlzdCgpXG4gIGZvcihpIGluIDE6blRyZWVzKXtcbiAgICByYW5kb21UcmVlc1tbaV1dIDwtIGJvb3RzdHJhcGluZyhkYXRhLCBpbmRleENsYXNzKVxuICB9XG4gIHJldHVybihyYW5kb21UcmVlcylcbn1cbmBgYCJ9 -->

```r
ensemble <- function(data, indexClass, nTrees){
  randomTrees <- list()
  for(i in 1:nTrees){
    randomTrees[[i]] <- bootstraping(data, indexClass)
  }
  return(randomTrees)
}
```

<!-- rnb-source-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxudm90ZXIgPC0gZnVuY3Rpb24oZW5zZW1ibGVMLCB0ZXN0RGF0YSl7XG4gIHJlc3VsdCA8LSB2ZWN0b3IoKVxuICBmb3IoaSBpbiAxOmxlbmd0aChlbnNlbWJsZUwpKXtcbiAgICAjKFwidHJlZVwiKVxuICAgICNwcmludChpKVxuICAgICNwcmludChlbnNlbWJsZUxbW2ldXSlcbiAgICBpZihsZW5ndGgod2Fsa1RyZWUoZW5zZW1ibGVMW1tpXV0sIHRlc3REYXRhKSkgIT0gMCl7XG4gICAgICByZXN1bHRbaV0gPC0gd2Fsa1RyZWUoZW5zZW1ibGVMW1tpXV0sIHRlc3REYXRhKVxuICAgIH0gXG4gIH1cbiAgI3JldHVybihzb3J0KHJlc3VsdCwgZGVjcmVhc2luZz1UUlVFKVsxXSlcbiAgI3ByaW50KHJlc3VsdClcbiAgcmV0dXJuKG5hbWVzKHdoaWNoLm1heCh0YWJsZShyZXN1bHQpKSkpXG59XG5gYGAifQ== -->

```r
voter <- function(ensembleL, testData){
  result <- vector()
  for(i in 1:length(ensembleL)){
    #("tree")
    #print(i)
    #print(ensembleL[[i]])
    if(length(walkTree(ensembleL[[i]], testData)) != 0){
      result[i] <- walkTree(ensembleL[[i]], testData)
    } 
  }
  #return(sort(result, decreasing=TRUE)[1])
  #print(result)
  return(names(which.max(table(result))))
}
```

<!-- rnb-source-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuY29tcHV0ZUFjYyA8LSBmdW5jdGlvbihlbnNlbWJsZUwsIHRlc3REYXRhLCBjbGFzc0luZGV4KXtcbiAgZGltIDwtIGxlbmd0aCh1bmlxdWUodGVzdERhdGFbLGNsYXNzSW5kZXhdKSlcbiAgcmVzdWx0cyA8LSBtYXRyaXgoMCwgbnJvdz1kaW0sIG5jb2wgPSBkaW0pXG4gIHByZWNpc2lvbiA8LSB2ZWN0b3IoKVxuICByZWNhbGwgPC0gdmVjdG9yKClcbiAgZm0gPC0gdmVjdG9yKClcbiAgXG4gIGZvcihpIGluIDE6bnJvdyh0ZXN0RGF0YSkpe1xuICAgICNwcmludCh0ZXN0RGF0YVtpLCBjbGFzc0luZGV4XSlcbiAgICAjcHJpbnQodm90ZXIoZW5zZW1ibGVMLCB0ZXN0RGF0YVtpLF0pKVxuICAgIHJlc3VsdCA8LSB2b3RlcihlbnNlbWJsZUwsIHRlc3REYXRhW2ksXSlcbiAgICBpZih0ZXN0RGF0YVtpLGNsYXNzSW5kZXhdID09IHJlc3VsdCl7XG4gICAgICAjcHJpbnQoXCJ0ZXN0MVwiKVxuICAgICAgY2VsbCA8LSBncmVwKHRlc3REYXRhW2ksY2xhc3NJbmRleF0sIHVuaXF1ZSh0ZXN0RGF0YVssY2xhc3NJbmRleF0pKVxuICAgICAgcmVzdWx0c1tjZWxsLGNlbGxdIDwtIHJlc3VsdHNbY2VsbCxjZWxsXSsxXG4gICAgfSBlbHNlIHtcbiAgICAgIHJvdyA8LSBncmVwKHJlc3VsdCwgdW5pcXVlKHRlc3REYXRhWyxjbGFzc0luZGV4XSkpXG4gICAgICBjb2wgPC0gZ3JlcCh0ZXN0RGF0YVtpLCBjbGFzc0luZGV4XSwgdW5pcXVlKHRlc3REYXRhWyxjbGFzc0luZGV4XSkpXG4gICAgICBcbiAgICAgIHJlc3VsdHNbcm93LGNvbF0gPSByZXN1bHRzW3Jvdyxjb2xdKzFcbiAgICB9XG4gIH1cbiAgXG4gIHByaW50KHJlc3VsdHMpXG4gIGZvcihpIGluIDE6ZGltKSB7XG4gICAgICByZWNhbGxbaV0gPC0gcmVzdWx0c1tpLGldL3N1bShyZXN1bHRzWyxpXSlcbiAgICAgIHByZWNpc2lvbltpXSA8LSByZXN1bHRzW2ksaV0vc3VtKHJlc3VsdHNbaSxdKVxuICAgICAgZm1baV0gPC0gMioocHJlY2lzaW9uW2ldKnJlY2FsbFtpXSkvKHByZWNpc2lvbltpXStyZWNhbGxbaV0pXG4gIH1cbiAgcmV0dXJuKGZtKVxufVxuYGBgIn0= -->

```r
computeAcc <- function(ensembleL, testData, classIndex){
  dim <- length(unique(testData[,classIndex]))
  results <- matrix(0, nrow=dim, ncol = dim)
  precision <- vector()
  recall <- vector()
  fm <- vector()
  
  for(i in 1:nrow(testData)){
    #print(testData[i, classIndex])
    #print(voter(ensembleL, testData[i,]))
    result <- voter(ensembleL, testData[i,])
    if(testData[i,classIndex] == result){
      #print("test1")
      cell <- grep(testData[i,classIndex], unique(testData[,classIndex]))
      results[cell,cell] <- results[cell,cell]+1
    } else {
      row <- grep(result, unique(testData[,classIndex]))
      col <- grep(testData[i, classIndex], unique(testData[,classIndex]))
      
      results[row,col] = results[row,col]+1
    }
  }
  
  print(results)
  for(i in 1:dim) {
      recall[i] <- results[i,i]/sum(results[,i])
      precision[i] <- results[i,i]/sum(results[i,])
      fm[i] <- 2*(precision[i]*recall[i])/(precision[i]+recall[i])
  }
  return(fm)
}
```

<!-- rnb-source-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxubGlicmFyeShwYXJhbGxlbClcbmxpYnJhcnkoaXRlcmF0b3JzKVxubGlicmFyeShmb3JlYWNoKVxubGlicmFyeShkb1BhcmFsbGVsKVxuc2NsYXNzIDwtIGxpc3QoKVxuaWRDbGFzcyA8LSBsaXN0KClcbnJhbmRvbUNsYXNzIDwtIGxpc3QoKVxuTGlzdENsYXNzIDwtbGlzdCgpXG5mb2xkcyA8LSBsaXN0KClcbmNvcmVzIDwtIGRldGVjdENvcmVzKClcbmNsIDwtIG1ha2VDbHVzdGVyKGNvcmVzWzFdKVxucmVnaXN0ZXJEb1BhcmFsbGVsKGNsKVxuYGBgIn0= -->

```r
library(parallel)
library(iterators)
library(foreach)
library(doParallel)
sclass <- list()
idClass <- list()
randomClass <- list()
ListClass <-list()
folds <- list()
cores <- detectCores()
cl <- makeCluster(cores[1])
registerDoParallel(cl)
```

<!-- rnb-source-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuaW9ub1Jlc3VsdHMxMCAgPC0gdmVjdG9yKClcbmlvbm9SZXN1bHRzMjUgIDwtIHZlY3RvcigpXG5pb25vUmVzdWx0czUwICA8LSB2ZWN0b3IoKVxuaW9ub1Jlc3VsdHMxMDAgPC0gdmVjdG9yKClcbmlvbm9SZXN1bHRzMTI1IDwtIHZlY3RvcigpXG5pb25vUmVzdWx0czE1MCA8LSB2ZWN0b3IoKVxuXG5kYXRhIDwtIHJlYWQuY3N2KFwiaW9ub3NwaGVyZS5jc3ZcIixoZWFkZXIgPSBUUlVFLHN0cmluZ3NBc0ZhY3RvcnMgPSBGQUxTRSxzZXA9XCIsXCIpXG4jZGF0YSA8LSBkYXRhWyxjKDIsMyw0LDUsNiw3LDgsOSwxMCwxMSwxMiwxMywxNCwxKV1cbmluZGV4Q2xhc3MgPC0gMzVcbmNsYXNzZXMgPC0gdW5pcXVlKGRhdGFbLGluZGV4Q2xhc3NdKVxuXG5mb3IoaiBpbiAxOjEwKXtcblxuZm9yKGkgaW4gMTpsZW5ndGgoY2xhc3Nlcykpe1xuICBzY2xhc3NbW2ldXSA8LSBkYXRhW3doaWNoKGRhdGFbLGluZGV4Q2xhc3NdID09IGNsYXNzZXNbaV0pLF1cbiAgaWRDbGFzc1tbaV1dIDwtIHJlcCgxOjEwLCAobnJvdyhzY2xhc3NbW2ldXSkvMTApICsgY2VpbGluZygobnJvdyhzY2xhc3NbW2ldXSklJTEwKS8xMCkpXG4gIGlmKGxlbmd0aChoZWFkKGlkQ2xhc3NbW2ldXSwgbnJvdyhzY2xhc3NbW2ldXSktbGVuZ3RoKGlkQ2xhc3NbW2ldXSkpKSA+IDAgKXtcbiAgICBpZENsYXNzW1tpXV0gPC0gaGVhZChpZENsYXNzW1tpXV0sIG5yb3coc2NsYXNzW1tpXV0pLWxlbmd0aChpZENsYXNzW1tpXV0pKX1cbiAgICByYW5kb21DbGFzc1tbaV1dIDwtIHNjbGFzc1tbaV1dW3NhbXBsZShzZXFfYWxvbmcoc2NsYXNzW1tpXV0pLCBsZW5ndGgoc2NsYXNzW1tpXV0pKV1cbiAgICBMaXN0Q2xhc3NbW2ldXSA8LSBzcGxpdChzY2xhc3NbW2ldXSwgaWRDbGFzc1tbaV1dKVxufVxuXG5mb3IoaSBpbiAxOjEwKXtcbiAgZm9sZHNbW2ldXSA8LSB2ZWN0b3IoKVxuICBmb3IoayBpbiAxOmxlbmd0aChjbGFzc2VzKSl7XG4gICAgZm9sZHNbW2ldXSA8LSByYmluZChmb2xkc1tbaV1dLCBMaXN0Q2xhc3NbW2tdXVtpXSlcbiAgfVxuICBmb2xkc1tbaV1dIDwtIGRvLmNhbGwocmJpbmQsIGZvbGRzW1tpXV0pXG59XG5cblxuXG5yZXN1bHRzMTAgPC0gZm9yZWFjaChpPTE6MTAsIC5jb21iaW5lPWNiaW5kLCAucGFja2FnZXMgPSAnZGF0YS50cmVlJykgJWRvcGFyJSB7XG4gIHRlc3QgPC0gZm9sZHNbW2ldXVxuICB0cmFpbiA8LSBkby5jYWxsKHJiaW5kLmRhdGEuZnJhbWUsIGZvbGRzWy1pXSlcbiAgXG4gIG5UcmVlcyA8LSAxMFxuICByYW5kb21UcmVlcyA8LSBlbnNlbWJsZSh0cmFpbiwgaW5kZXhDbGFzcywgblRyZWVzKVxuICB0ZW1wUmVzdWx0cyA8LSBjb21wdXRlQWNjKHJhbmRvbVRyZWVzLCB0ZXN0LCBpbmRleENsYXNzKVxuICB0ZW1wUmVzdWx0c1xufVxuXG5yZXN1bHRzMjUgPC0gZm9yZWFjaChpPTE6MTAsIC5jb21iaW5lPWNiaW5kLCAucGFja2FnZXMgPSAnZGF0YS50cmVlJykgJWRvcGFyJSB7XG4gIHRlc3QgPC0gZm9sZHNbW2ldXVxuICB0cmFpbiA8LSBkby5jYWxsKHJiaW5kLmRhdGEuZnJhbWUsIGZvbGRzWy1pXSlcbiAgXG4gIG5UcmVlcyA8LSAyNVxuICByYW5kb21UcmVlcyA8LSBlbnNlbWJsZSh0cmFpbiwgaW5kZXhDbGFzcywgblRyZWVzKVxuICB0ZW1wUmVzdWx0cyA8LSBjb21wdXRlQWNjKHJhbmRvbVRyZWVzLCB0ZXN0LCBpbmRleENsYXNzKVxuICB0ZW1wUmVzdWx0c1xufVxuXG5yZXN1bHRzNTAgPC0gZm9yZWFjaChpPTE6MTAsIC5jb21iaW5lPWNiaW5kLCAucGFja2FnZXMgPSAnZGF0YS50cmVlJykgJWRvcGFyJSB7XG4gIHRlc3QgPC0gZm9sZHNbW2ldXVxuICB0cmFpbiA8LSBkby5jYWxsKHJiaW5kLmRhdGEuZnJhbWUsIGZvbGRzWy1pXSlcbiAgXG4gIG5UcmVlcyA8LSA1MFxuICByYW5kb21UcmVlcyA8LSBlbnNlbWJsZSh0cmFpbiwgaW5kZXhDbGFzcywgblRyZWVzKVxuICB0ZW1wUmVzdWx0cyA8LSBjb21wdXRlQWNjKHJhbmRvbVRyZWVzLCB0ZXN0LCBpbmRleENsYXNzKVxuICB0ZW1wUmVzdWx0c1xufVxuXG5yZXN1bHRzMTAwIDwtIGZvcmVhY2goaT0xOjEwLCAuY29tYmluZT1jYmluZCwgLnBhY2thZ2VzID0gJ2RhdGEudHJlZScpICVkb3BhciUge1xuICB0ZXN0IDwtIGZvbGRzW1tpXV1cbiAgdHJhaW4gPC0gZG8uY2FsbChyYmluZC5kYXRhLmZyYW1lLCBmb2xkc1staV0pXG4gIFxuICBuVHJlZXMgPC0gMTAwXG4gIHJhbmRvbVRyZWVzIDwtIGVuc2VtYmxlKHRyYWluLCBpbmRleENsYXNzLCBuVHJlZXMpXG4gIHRlbXBSZXN1bHRzIDwtIGNvbXB1dGVBY2MocmFuZG9tVHJlZXMsIHRlc3QsIGluZGV4Q2xhc3MpXG4gIHRlbXBSZXN1bHRzXG59XG5cbnJlc3VsdHMxMjUgPC0gZm9yZWFjaChpPTE6MTAsIC5jb21iaW5lPWNiaW5kLCAucGFja2FnZXMgPSAnZGF0YS50cmVlJykgJWRvcGFyJSB7XG4gIHRlc3QgPC0gZm9sZHNbW2ldXVxuICB0cmFpbiA8LSBkby5jYWxsKHJiaW5kLmRhdGEuZnJhbWUsIGZvbGRzWy1pXSlcbiAgXG4gIG5UcmVlcyA8LSAxMjVcbiAgcmFuZG9tVHJlZXMgPC0gZW5zZW1ibGUodHJhaW4sIGluZGV4Q2xhc3MsIG5UcmVlcylcbiAgdGVtcFJlc3VsdHMgPC0gY29tcHV0ZUFjYyhyYW5kb21UcmVlcywgdGVzdCwgaW5kZXhDbGFzcylcbiAgdGVtcFJlc3VsdHNcbn1cblxucmVzdWx0czE1MCA8LSBmb3JlYWNoKGk9MToxMCwgLmNvbWJpbmU9Y2JpbmQsIC5wYWNrYWdlcyA9ICdkYXRhLnRyZWUnKSAlZG9wYXIlIHtcbiAgdGVzdCA8LSBmb2xkc1tbaV1dXG4gIHRyYWluIDwtIGRvLmNhbGwocmJpbmQuZGF0YS5mcmFtZSwgZm9sZHNbLWldKVxuICBcbiAgblRyZWVzIDwtIDE1MFxuICByYW5kb21UcmVlcyA8LSBlbnNlbWJsZSh0cmFpbiwgaW5kZXhDbGFzcywgblRyZWVzKVxuICB0ZW1wUmVzdWx0cyA8LSBjb21wdXRlQWNjKHJhbmRvbVRyZWVzLCB0ZXN0LCBpbmRleENsYXNzKVxuICB0ZW1wUmVzdWx0c1xufVxuXG5pb25vUmVzdWx0czEwICA8LSBjKCBpb25vUmVzdWx0czEwLCAgcmVzdWx0czEwKVxuaW9ub1Jlc3VsdHMyNSAgPC0gYyggaW9ub1Jlc3VsdHMyNSwgIHJlc3VsdHMyNSlcbmlvbm9SZXN1bHRzNTAgIDwtIGMoIGlvbm9SZXN1bHRzNTAsICByZXN1bHRzNTApXG5pb25vUmVzdWx0czEwMCA8LSBjKGlvbm9SZXN1bHRzMTAwLCByZXN1bHRzMTAwKVxuaW9ub1Jlc3VsdHMxMjUgPC0gYyhpb25vUmVzdWx0czEyNSwgcmVzdWx0czEyNSlcbmlvbm9SZXN1bHRzMTUwIDwtIGMoaW9ub1Jlc3VsdHMxNTAsIHJlc3VsdHMxNTApXG5cbn1cbmBgYCJ9 -->

```r
ionoResults10  <- vector()
ionoResults25  <- vector()
ionoResults50  <- vector()
ionoResults100 <- vector()
ionoResults125 <- vector()
ionoResults150 <- vector()

data <- read.csv("ionosphere.csv",header = TRUE,stringsAsFactors = FALSE,sep=",")
#data <- data[,c(2,3,4,5,6,7,8,9,10,11,12,13,14,1)]
indexClass <- 35
classes <- unique(data[,indexClass])

for(j in 1:10){

for(i in 1:length(classes)){
  sclass[[i]] <- data[which(data[,indexClass] == classes[i]),]
  idClass[[i]] <- rep(1:10, (nrow(sclass[[i]])/10) + ceiling((nrow(sclass[[i]])%%10)/10))
  if(length(head(idClass[[i]], nrow(sclass[[i]])-length(idClass[[i]]))) > 0 ){
    idClass[[i]] <- head(idClass[[i]], nrow(sclass[[i]])-length(idClass[[i]]))}
    randomClass[[i]] <- sclass[[i]][sample(seq_along(sclass[[i]]), length(sclass[[i]]))]
    ListClass[[i]] <- split(sclass[[i]], idClass[[i]])
}

for(i in 1:10){
  folds[[i]] <- vector()
  for(k in 1:length(classes)){
    folds[[i]] <- rbind(folds[[i]], ListClass[[k]][i])
  }
  folds[[i]] <- do.call(rbind, folds[[i]])
}



results10 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  
  nTrees <- 10
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

results25 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  
  nTrees <- 25
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

results50 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  
  nTrees <- 50
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

results100 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  
  nTrees <- 100
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

results125 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  
  nTrees <- 125
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

results150 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  
  nTrees <- 150
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

ionoResults10  <- c( ionoResults10,  results10)
ionoResults25  <- c( ionoResults25,  results25)
ionoResults50  <- c( ionoResults50,  results50)
ionoResults100 <- c(ionoResults100, results100)
ionoResults125 <- c(ionoResults125, results125)
ionoResults150 <- c(ionoResults150, results150)

}
```

<!-- rnb-source-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuXG53aW5lUmVzdWx0czEwICA8LSB2ZWN0b3IoKVxud2luZVJlc3VsdHMyNSAgPC0gdmVjdG9yKClcbndpbmVSZXN1bHRzNTAgIDwtIHZlY3RvcigpXG53aW5lUmVzdWx0czEwMCA8LSB2ZWN0b3IoKVxud2luZVJlc3VsdHMxMjUgPC0gdmVjdG9yKClcbndpbmVSZXN1bHRzMTUwIDwtIHZlY3RvcigpXG5cbmRhdGEgPC0gcmVhZC5jc3YoXCJ3aW5lLmNzdlwiLGhlYWRlciA9IFRSVUUsc3RyaW5nc0FzRmFjdG9ycyA9IEZBTFNFLHNlcD1cIixcIilcbmRhdGEgPC0gZGF0YVssYygyOjE0LDEpXVxuaW5kZXhDbGFzcyA8LSAxNFxuY2xhc3NlcyA8LSB1bmlxdWUoZGF0YVssaW5kZXhDbGFzc10pXG5cbmZvcihqIGluIDE6MTApe1xuXG5mb3IoaSBpbiAxOmxlbmd0aChjbGFzc2VzKSl7XG4gIHNjbGFzc1tbaV1dIDwtIGRhdGFbd2hpY2goZGF0YVssaW5kZXhDbGFzc10gPT0gY2xhc3Nlc1tpXSksXVxuICBpZENsYXNzW1tpXV0gPC0gcmVwKDE6MTAsIChucm93KHNjbGFzc1tbaV1dKS8xMCkgKyBjZWlsaW5nKChucm93KHNjbGFzc1tbaV1dKSUlMTApLzEwKSlcbiAgaWYobGVuZ3RoKGhlYWQoaWRDbGFzc1tbaV1dLCBucm93KHNjbGFzc1tbaV1dKS1sZW5ndGgoaWRDbGFzc1tbaV1dKSkpID4gMCApe1xuICAgIGlkQ2xhc3NbW2ldXSA8LSBoZWFkKGlkQ2xhc3NbW2ldXSwgbnJvdyhzY2xhc3NbW2ldXSktbGVuZ3RoKGlkQ2xhc3NbW2ldXSkpfVxuICAgIHJhbmRvbUNsYXNzW1tpXV0gPC0gc2NsYXNzW1tpXV1bc2FtcGxlKHNlcV9hbG9uZyhzY2xhc3NbW2ldXSksIGxlbmd0aChzY2xhc3NbW2ldXSkpXVxuICAgIExpc3RDbGFzc1tbaV1dIDwtIHNwbGl0KHNjbGFzc1tbaV1dLCBpZENsYXNzW1tpXV0pXG59XG5cbmZvcihpIGluIDE6MTApe1xuICBmb2xkc1tbaV1dIDwtIHZlY3RvcigpXG4gIGZvcihrIGluIDE6bGVuZ3RoKGNsYXNzZXMpKXtcbiAgICBmb2xkc1tbaV1dIDwtIHJiaW5kKGZvbGRzW1tpXV0sIExpc3RDbGFzc1tba11dW2ldKVxuICB9XG4gIGZvbGRzW1tpXV0gPC0gZG8uY2FsbChyYmluZCwgZm9sZHNbW2ldXSlcbn1cblxuXG5cbnJlc3VsdHMxMCA8LSBmb3JlYWNoKGk9MToxMCwgLmNvbWJpbmU9Y2JpbmQsIC5wYWNrYWdlcyA9ICdkYXRhLnRyZWUnKSAlZG9wYXIlIHtcbiAgdGVzdCA8LSBmb2xkc1tbaV1dXG4gIHRyYWluIDwtIGRvLmNhbGwocmJpbmQuZGF0YS5mcmFtZSwgZm9sZHNbLWldKVxuICBcbiAgblRyZWVzIDwtIDEwXG4gIHJhbmRvbVRyZWVzIDwtIGVuc2VtYmxlKHRyYWluLCBpbmRleENsYXNzLCBuVHJlZXMpXG4gIHRlbXBSZXN1bHRzIDwtIGNvbXB1dGVBY2MocmFuZG9tVHJlZXMsIHRlc3QsIGluZGV4Q2xhc3MpXG4gIHRlbXBSZXN1bHRzXG59XG5cbnJlc3VsdHMyNSA8LSBmb3JlYWNoKGk9MToxMCwgLmNvbWJpbmU9Y2JpbmQsIC5wYWNrYWdlcyA9ICdkYXRhLnRyZWUnKSAlZG9wYXIlIHtcbiAgdGVzdCA8LSBmb2xkc1tbaV1dXG4gIHRyYWluIDwtIGRvLmNhbGwocmJpbmQuZGF0YS5mcmFtZSwgZm9sZHNbLWldKVxuICBcbiAgblRyZWVzIDwtIDI1XG4gIHJhbmRvbVRyZWVzIDwtIGVuc2VtYmxlKHRyYWluLCBpbmRleENsYXNzLCBuVHJlZXMpXG4gIHRlbXBSZXN1bHRzIDwtIGNvbXB1dGVBY2MocmFuZG9tVHJlZXMsIHRlc3QsIGluZGV4Q2xhc3MpXG4gIHRlbXBSZXN1bHRzXG59XG5cbnJlc3VsdHM1MCA8LSBmb3JlYWNoKGk9MToxMCwgLmNvbWJpbmU9Y2JpbmQsIC5wYWNrYWdlcyA9ICdkYXRhLnRyZWUnKSAlZG9wYXIlIHtcbiAgdGVzdCA8LSBmb2xkc1tbaV1dXG4gIHRyYWluIDwtIGRvLmNhbGwocmJpbmQuZGF0YS5mcmFtZSwgZm9sZHNbLWldKVxuICBcbiAgblRyZWVzIDwtIDUwXG4gIHJhbmRvbVRyZWVzIDwtIGVuc2VtYmxlKHRyYWluLCBpbmRleENsYXNzLCBuVHJlZXMpXG4gIHRlbXBSZXN1bHRzIDwtIGNvbXB1dGVBY2MocmFuZG9tVHJlZXMsIHRlc3QsIGluZGV4Q2xhc3MpXG4gIHRlbXBSZXN1bHRzXG59XG5cbnJlc3VsdHMxMDAgPC0gZm9yZWFjaChpPTE6MTAsIC5jb21iaW5lPWNiaW5kLCAucGFja2FnZXMgPSAnZGF0YS50cmVlJykgJWRvcGFyJSB7XG4gIHRlc3QgPC0gZm9sZHNbW2ldXVxuICB0cmFpbiA8LSBkby5jYWxsKHJiaW5kLmRhdGEuZnJhbWUsIGZvbGRzWy1pXSlcbiAgXG4gIG5UcmVlcyA8LSAxMDBcbiAgcmFuZG9tVHJlZXMgPC0gZW5zZW1ibGUodHJhaW4sIGluZGV4Q2xhc3MsIG5UcmVlcylcbiAgdGVtcFJlc3VsdHMgPC0gY29tcHV0ZUFjYyhyYW5kb21UcmVlcywgdGVzdCwgaW5kZXhDbGFzcylcbiAgdGVtcFJlc3VsdHNcbn1cblxucmVzdWx0czEyNSA8LSBmb3JlYWNoKGk9MToxMCwgLmNvbWJpbmU9Y2JpbmQsIC5wYWNrYWdlcyA9ICdkYXRhLnRyZWUnKSAlZG9wYXIlIHtcbiAgdGVzdCA8LSBmb2xkc1tbaV1dXG4gIHRyYWluIDwtIGRvLmNhbGwocmJpbmQuZGF0YS5mcmFtZSwgZm9sZHNbLWldKVxuICBcbiAgblRyZWVzIDwtIDEyNVxuICByYW5kb21UcmVlcyA8LSBlbnNlbWJsZSh0cmFpbiwgaW5kZXhDbGFzcywgblRyZWVzKVxuICB0ZW1wUmVzdWx0cyA8LSBjb21wdXRlQWNjKHJhbmRvbVRyZWVzLCB0ZXN0LCBpbmRleENsYXNzKVxuICB0ZW1wUmVzdWx0c1xufVxuXG5yZXN1bHRzMTUwIDwtIGZvcmVhY2goaT0xOjEwLCAuY29tYmluZT1jYmluZCwgLnBhY2thZ2VzID0gJ2RhdGEudHJlZScpICVkb3BhciUge1xuICB0ZXN0IDwtIGZvbGRzW1tpXV1cbiAgdHJhaW4gPC0gZG8uY2FsbChyYmluZC5kYXRhLmZyYW1lLCBmb2xkc1staV0pXG4gIFxuICBuVHJlZXMgPC0gMTUwXG4gIHJhbmRvbVRyZWVzIDwtIGVuc2VtYmxlKHRyYWluLCBpbmRleENsYXNzLCBuVHJlZXMpXG4gIHRlbXBSZXN1bHRzIDwtIGNvbXB1dGVBY2MocmFuZG9tVHJlZXMsIHRlc3QsIGluZGV4Q2xhc3MpXG4gIHRlbXBSZXN1bHRzXG59XG5cbndpbmVSZXN1bHRzMTAgIDwtIGMoIHdpbmVSZXN1bHRzMTAsICByZXN1bHRzMTApXG53aW5lUmVzdWx0czI1ICA8LSBjKCB3aW5lUmVzdWx0czI1LCAgcmVzdWx0czI1KVxud2luZVJlc3VsdHM1MCAgPC0gYyggd2luZVJlc3VsdHM1MCwgIHJlc3VsdHM1MClcbndpbmVSZXN1bHRzMTAwIDwtIGMod2luZVJlc3VsdHMxMDAsIHJlc3VsdHMxMDApXG53aW5lUmVzdWx0czEyNSA8LSBjKHdpbmVSZXN1bHRzMTI1LCByZXN1bHRzMTI1KVxud2luZVJlc3VsdHMxNTAgPC0gYyh3aW5lUmVzdWx0czE1MCwgcmVzdWx0czE1MClcblxufVxuYGBgIn0= -->

```r

wineResults10  <- vector()
wineResults25  <- vector()
wineResults50  <- vector()
wineResults100 <- vector()
wineResults125 <- vector()
wineResults150 <- vector()

data <- read.csv("wine.csv",header = TRUE,stringsAsFactors = FALSE,sep=",")
data <- data[,c(2:14,1)]
indexClass <- 14
classes <- unique(data[,indexClass])

for(j in 1:10){

for(i in 1:length(classes)){
  sclass[[i]] <- data[which(data[,indexClass] == classes[i]),]
  idClass[[i]] <- rep(1:10, (nrow(sclass[[i]])/10) + ceiling((nrow(sclass[[i]])%%10)/10))
  if(length(head(idClass[[i]], nrow(sclass[[i]])-length(idClass[[i]]))) > 0 ){
    idClass[[i]] <- head(idClass[[i]], nrow(sclass[[i]])-length(idClass[[i]]))}
    randomClass[[i]] <- sclass[[i]][sample(seq_along(sclass[[i]]), length(sclass[[i]]))]
    ListClass[[i]] <- split(sclass[[i]], idClass[[i]])
}

for(i in 1:10){
  folds[[i]] <- vector()
  for(k in 1:length(classes)){
    folds[[i]] <- rbind(folds[[i]], ListClass[[k]][i])
  }
  folds[[i]] <- do.call(rbind, folds[[i]])
}



results10 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  
  nTrees <- 10
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

results25 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  
  nTrees <- 25
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

results50 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  
  nTrees <- 50
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

results100 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  
  nTrees <- 100
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

results125 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  
  nTrees <- 125
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

results150 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  
  nTrees <- 150
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

wineResults10  <- c( wineResults10,  results10)
wineResults25  <- c( wineResults25,  results25)
wineResults50  <- c( wineResults50,  results50)
wineResults100 <- c(wineResults100, results100)
wineResults125 <- c(wineResults125, results125)
wineResults150 <- c(wineResults150, results150)

}
```

<!-- rnb-source-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuXG5waW1hUmVzdWx0czEwICA8LSB2ZWN0b3IoKVxucGltYVJlc3VsdHMyNSAgPC0gdmVjdG9yKClcbnBpbWFSZXN1bHRzNTAgIDwtIHZlY3RvcigpXG5waW1hUmVzdWx0czEwMCA8LSB2ZWN0b3IoKVxucGltYVJlc3VsdHMxMjUgPC0gdmVjdG9yKClcbnBpbWFSZXN1bHRzMTUwIDwtIHZlY3RvcigpXG5cbmRhdGEgPC0gcmVhZC5jc3YoXCJwaW1hLmNzdlwiLGhlYWRlciA9IFRSVUUsc3RyaW5nc0FzRmFjdG9ycyA9IEZBTFNFLHNlcD1cIlxcdFwiKVxuI2RhdGEgPC0gZGF0YVssYygyLDMsNCw1LDYsNyw4LDksMTAsMTEsMTIsMTMsMTQsMSldXG5pbmRleENsYXNzIDwtIDlcbmNsYXNzZXMgPC0gdW5pcXVlKGRhdGFbLGluZGV4Q2xhc3NdKVxuXG5mb3IoaiBpbiAxOjEwKXtcblxuZm9yKGkgaW4gMTpsZW5ndGgoY2xhc3Nlcykpe1xuICBzY2xhc3NbW2ldXSA8LSBkYXRhW3doaWNoKGRhdGFbLGluZGV4Q2xhc3NdID09IGNsYXNzZXNbaV0pLF1cbiAgaWRDbGFzc1tbaV1dIDwtIHJlcCgxOjEwLCAobnJvdyhzY2xhc3NbW2ldXSkvMTApICsgY2VpbGluZygobnJvdyhzY2xhc3NbW2ldXSklJTEwKS8xMCkpXG4gIGlmKGxlbmd0aChoZWFkKGlkQ2xhc3NbW2ldXSwgbnJvdyhzY2xhc3NbW2ldXSktbGVuZ3RoKGlkQ2xhc3NbW2ldXSkpKSA+IDAgKXtcbiAgICBpZENsYXNzW1tpXV0gPC0gaGVhZChpZENsYXNzW1tpXV0sIG5yb3coc2NsYXNzW1tpXV0pLWxlbmd0aChpZENsYXNzW1tpXV0pKX1cbiAgICByYW5kb21DbGFzc1tbaV1dIDwtIHNjbGFzc1tbaV1dW3NhbXBsZShzZXFfYWxvbmcoc2NsYXNzW1tpXV0pLCBsZW5ndGgoc2NsYXNzW1tpXV0pKV1cbiAgICBMaXN0Q2xhc3NbW2ldXSA8LSBzcGxpdChzY2xhc3NbW2ldXSwgaWRDbGFzc1tbaV1dKVxufVxuXG5mb3IoaSBpbiAxOjEwKXtcbiAgZm9sZHNbW2ldXSA8LSB2ZWN0b3IoKVxuICBmb3IoayBpbiAxOmxlbmd0aChjbGFzc2VzKSl7XG4gICAgZm9sZHNbW2ldXSA8LSByYmluZChmb2xkc1tbaV1dLCBMaXN0Q2xhc3NbW2tdXVtpXSlcbiAgfVxuICBmb2xkc1tbaV1dIDwtIGRvLmNhbGwocmJpbmQsIGZvbGRzW1tpXV0pXG59XG5cbnJlc3VsdHMxMCA8LSBmb3JlYWNoKGk9MToxMCwgLmNvbWJpbmU9Y2JpbmQsIC5wYWNrYWdlcyA9ICdkYXRhLnRyZWUnKSAlZG9wYXIlIHtcbiAgdGVzdCA8LSBmb2xkc1tbaV1dXG4gIHRyYWluIDwtIGRvLmNhbGwocmJpbmQuZGF0YS5mcmFtZSwgZm9sZHNbLWldKVxuICBcbiAgblRyZWVzIDwtIDEwXG4gIHJhbmRvbVRyZWVzIDwtIGVuc2VtYmxlKHRyYWluLCBpbmRleENsYXNzLCBuVHJlZXMpXG4gIHRlbXBSZXN1bHRzIDwtIGNvbXB1dGVBY2MocmFuZG9tVHJlZXMsIHRlc3QsIGluZGV4Q2xhc3MpXG4gIHRlbXBSZXN1bHRzXG59XG5cbnJlc3VsdHMyNSA8LSBmb3JlYWNoKGk9MToxMCwgLmNvbWJpbmU9Y2JpbmQsIC5wYWNrYWdlcyA9ICdkYXRhLnRyZWUnKSAlZG9wYXIlIHtcbiAgdGVzdCA8LSBmb2xkc1tbaV1dXG4gIHRyYWluIDwtIGRvLmNhbGwocmJpbmQuZGF0YS5mcmFtZSwgZm9sZHNbLWldKVxuXG4gIG5UcmVlcyA8LSAyNVxuICByYW5kb21UcmVlcyA8LSBlbnNlbWJsZSh0cmFpbiwgaW5kZXhDbGFzcywgblRyZWVzKVxuICB0ZW1wUmVzdWx0cyA8LSBjb21wdXRlQWNjKHJhbmRvbVRyZWVzLCB0ZXN0LCBpbmRleENsYXNzKVxuICB0ZW1wUmVzdWx0c1xufVxuXG5yZXN1bHRzNTAgPC0gZm9yZWFjaChpPTE6MTAsIC5jb21iaW5lPWNiaW5kLCAucGFja2FnZXMgPSAnZGF0YS50cmVlJykgJWRvcGFyJSB7XG4gIHRlc3QgPC0gZm9sZHNbW2ldXVxuICB0cmFpbiA8LSBkby5jYWxsKHJiaW5kLmRhdGEuZnJhbWUsIGZvbGRzWy1pXSlcblxuICBuVHJlZXMgPC0gNTBcbiAgcmFuZG9tVHJlZXMgPC0gZW5zZW1ibGUodHJhaW4sIGluZGV4Q2xhc3MsIG5UcmVlcylcbiAgdGVtcFJlc3VsdHMgPC0gY29tcHV0ZUFjYyhyYW5kb21UcmVlcywgdGVzdCwgaW5kZXhDbGFzcylcbiAgdGVtcFJlc3VsdHNcbn1cblxucmVzdWx0czEwMCA8LSBmb3JlYWNoKGk9MToxMCwgLmNvbWJpbmU9Y2JpbmQsIC5wYWNrYWdlcyA9ICdkYXRhLnRyZWUnKSAlZG9wYXIlIHtcbiAgdGVzdCA8LSBmb2xkc1tbaV1dXG4gIHRyYWluIDwtIGRvLmNhbGwocmJpbmQuZGF0YS5mcmFtZSwgZm9sZHNbLWldKVxuXG4gIG5UcmVlcyA8LSAxMDBcbiAgcmFuZG9tVHJlZXMgPC0gZW5zZW1ibGUodHJhaW4sIGluZGV4Q2xhc3MsIG5UcmVlcylcbiAgdGVtcFJlc3VsdHMgPC0gY29tcHV0ZUFjYyhyYW5kb21UcmVlcywgdGVzdCwgaW5kZXhDbGFzcylcbiAgdGVtcFJlc3VsdHNcbn1cblxucmVzdWx0czEyNSA8LSBmb3JlYWNoKGk9MToxMCwgLmNvbWJpbmU9Y2JpbmQsIC5wYWNrYWdlcyA9ICdkYXRhLnRyZWUnKSAlZG9wYXIlIHtcbiAgdGVzdCA8LSBmb2xkc1tbaV1dXG4gIHRyYWluIDwtIGRvLmNhbGwocmJpbmQuZGF0YS5mcmFtZSwgZm9sZHNbLWldKVxuXG4gIG5UcmVlcyA8LSAxMjVcbiAgcmFuZG9tVHJlZXMgPC0gZW5zZW1ibGUodHJhaW4sIGluZGV4Q2xhc3MsIG5UcmVlcylcbiAgdGVtcFJlc3VsdHMgPC0gY29tcHV0ZUFjYyhyYW5kb21UcmVlcywgdGVzdCwgaW5kZXhDbGFzcylcbiAgdGVtcFJlc3VsdHNcbn1cblxucmVzdWx0czE1MCA8LSBmb3JlYWNoKGk9MToxMCwgLmNvbWJpbmU9Y2JpbmQsIC5wYWNrYWdlcyA9ICdkYXRhLnRyZWUnKSAlZG9wYXIlIHtcbiAgdGVzdCA8LSBmb2xkc1tbaV1dXG4gIHRyYWluIDwtIGRvLmNhbGwocmJpbmQuZGF0YS5mcmFtZSwgZm9sZHNbLWldKVxuXG4gIG5UcmVlcyA8LSAxNTBcbiAgcmFuZG9tVHJlZXMgPC0gZW5zZW1ibGUodHJhaW4sIGluZGV4Q2xhc3MsIG5UcmVlcylcbiAgdGVtcFJlc3VsdHMgPC0gY29tcHV0ZUFjYyhyYW5kb21UcmVlcywgdGVzdCwgaW5kZXhDbGFzcylcbiAgdGVtcFJlc3VsdHNcbn1cblxucGltYVJlc3VsdHMxMCAgPC0gYyggcGltYVJlc3VsdHMxMCwgIHJlc3VsdHMxMClcbnBpbWFSZXN1bHRzMjUgIDwtIGMoIHBpbWFSZXN1bHRzMjUsICByZXN1bHRzMjUpXG5waW1hUmVzdWx0czUwICA8LSBjKCBwaW1hUmVzdWx0czUwLCAgcmVzdWx0czUwKVxucGltYVJlc3VsdHMxMDAgPC0gYyhwaW1hUmVzdWx0czEwMCwgcmVzdWx0czEwMClcbnBpbWFSZXN1bHRzMTI1IDwtIGMocGltYVJlc3VsdHMxMjUsIHJlc3VsdHMxMjUpXG5waW1hUmVzdWx0czE1MCA8LSBjKHBpbWFSZXN1bHRzMTUwLCByZXN1bHRzMTUwKVxuXG59XG5cbnN0b3BDbHVzdGVyKGNsKVxuXG5gYGAifQ== -->

```r

pimaResults10  <- vector()
pimaResults25  <- vector()
pimaResults50  <- vector()
pimaResults100 <- vector()
pimaResults125 <- vector()
pimaResults150 <- vector()

data <- read.csv("pima.csv",header = TRUE,stringsAsFactors = FALSE,sep="\t")
#data <- data[,c(2,3,4,5,6,7,8,9,10,11,12,13,14,1)]
indexClass <- 9
classes <- unique(data[,indexClass])

for(j in 1:10){

for(i in 1:length(classes)){
  sclass[[i]] <- data[which(data[,indexClass] == classes[i]),]
  idClass[[i]] <- rep(1:10, (nrow(sclass[[i]])/10) + ceiling((nrow(sclass[[i]])%%10)/10))
  if(length(head(idClass[[i]], nrow(sclass[[i]])-length(idClass[[i]]))) > 0 ){
    idClass[[i]] <- head(idClass[[i]], nrow(sclass[[i]])-length(idClass[[i]]))}
    randomClass[[i]] <- sclass[[i]][sample(seq_along(sclass[[i]]), length(sclass[[i]]))]
    ListClass[[i]] <- split(sclass[[i]], idClass[[i]])
}

for(i in 1:10){
  folds[[i]] <- vector()
  for(k in 1:length(classes)){
    folds[[i]] <- rbind(folds[[i]], ListClass[[k]][i])
  }
  folds[[i]] <- do.call(rbind, folds[[i]])
}

results10 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  
  nTrees <- 10
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

results25 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])

  nTrees <- 25
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

results50 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])

  nTrees <- 50
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

results100 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])

  nTrees <- 100
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

results125 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])

  nTrees <- 125
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

results150 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])

  nTrees <- 150
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}

pimaResults10  <- c( pimaResults10,  results10)
pimaResults25  <- c( pimaResults25,  results25)
pimaResults50  <- c( pimaResults50,  results50)
pimaResults100 <- c(pimaResults100, results100)
pimaResults125 <- c(pimaResults125, results125)
pimaResults150 <- c(pimaResults150, results150)

}

stopCluster(cl)

```

<!-- rnb-source-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxud2RiY1Jlc3VsdHMxMCAgPC0gdmVjdG9yKClcbndkYmNSZXN1bHRzMjUgIDwtIHZlY3RvcigpXG53ZGJjUmVzdWx0czUwICA8LSB2ZWN0b3IoKVxud2RiY1Jlc3VsdHMxMDAgPC0gdmVjdG9yKClcbndkYmNSZXN1bHRzMTI1IDwtIHZlY3RvcigpXG53ZGJjUmVzdWx0czE1MCA8LSB2ZWN0b3IoKVxuZGF0YSA8LSByZWFkLmNzdihcIndkYmMuY3N2XCIsaGVhZGVyID0gVFJVRSxzdHJpbmdzQXNGYWN0b3JzID0gRkFMU0Usc2VwPVwiLFwiKVxuZGF0YSRJRCA8LSBOVUxMXG5kYXRhIDwtIGRhdGFbLGMoMjozMSwxKV1cbmluZGV4Q2xhc3MgPC0gMzFcbmNsYXNzZXMgPC0gdW5pcXVlKGRhdGFbLGluZGV4Q2xhc3NdKVxuZm9yKGogaW4gMToxMCl7XG5mb3IoaSBpbiAxOmxlbmd0aChjbGFzc2VzKSl7XG4gIHNjbGFzc1tbaV1dIDwtIGRhdGFbd2hpY2goZGF0YVssaW5kZXhDbGFzc10gPT0gY2xhc3Nlc1tpXSksXVxuICBpZENsYXNzW1tpXV0gPC0gcmVwKDE6MTAsIChucm93KHNjbGFzc1tbaV1dKS8xMCkgKyBjZWlsaW5nKChucm93KHNjbGFzc1tbaV1dKSUlMTApLzEwKSlcbiAgaWYobGVuZ3RoKGhlYWQoaWRDbGFzc1tbaV1dLCBucm93KHNjbGFzc1tbaV1dKS1sZW5ndGgoaWRDbGFzc1tbaV1dKSkpID4gMCApe1xuICAgIGlkQ2xhc3NbW2ldXSA8LSBoZWFkKGlkQ2xhc3NbW2ldXSwgbnJvdyhzY2xhc3NbW2ldXSktbGVuZ3RoKGlkQ2xhc3NbW2ldXSkpfVxuICAgIHJhbmRvbUNsYXNzW1tpXV0gPC0gc2NsYXNzW1tpXV1bc2FtcGxlKHNlcV9hbG9uZyhzY2xhc3NbW2ldXSksIGxlbmd0aChzY2xhc3NbW2ldXSkpXVxuICBmb2xkc1tbaV1dIDwtIHZlY3RvcigpXG4gIGZvcihrIGluIDE6bGVuZ3RoKGNsYXNzZXMpKXtcbiAgICBmb2xkc1tbaV1dIDwtIHJiaW5kKGZvbGRzW1tpXV0sIExpc3RDbGFzc1tba11dW2ldKVxuICB9XG4gIGZvbGRzW1tpXV0gPC0gZG8uY2FsbChyYmluZCwgZm9sZHNbW2ldXSlcbn1cbnJlc3VsdHMxMCA8LSBmb3JlYWNoKGk9MToxMCwgLmNvbWJpbmU9Y2JpbmQsIC5wYWNrYWdlcyA9ICdkYXRhLnRyZWUnKSAlZG9wYXIlIHtcbiAgdGVzdCA8LSBmb2xkc1tbaV1dXG4gIHRyYWluIDwtIGRvLmNhbGwocmJpbmQuZGF0YS5mcmFtZSwgZm9sZHNbLWldKVxuICBcbiAgblRyZWVzIDwtIDEwXG4gIHJhbmRvbVRyZWVzIDwtIGVuc2VtYmxlKHRyYWluLCBpbmRleENsYXNzLCBuVHJlZXMpXG4gIHRlbXBSZXN1bHRzIDwtIGNvbXB1dGVBY2MocmFuZG9tVHJlZXMsIHRlc3QsIGluZGV4Q2xhc3MpXG4gIHRlbXBSZXN1bHRzXG59XG5yZXN1bHRzMjUgPC0gZm9yZWFjaChpPTE6MTAsIC5jb21iaW5lPWNiaW5kLCAucGFja2FnZXMgPSAnZGF0YS50cmVlJykgJWRvcGFyJSB7XG4gIHRlc3QgPC0gZm9sZHNbW2ldXVxuICB0cmFpbiA8LSBkby5jYWxsKHJiaW5kLmRhdGEuZnJhbWUsIGZvbGRzWy1pXSlcbiAgblRyZWVzIDwtIDI1XG4gIHJhbmRvbVRyZWVzIDwtIGVuc2VtYmxlKHRyYWluLCBpbmRleENsYXNzLCBuVHJlZXMpXG4gIHRlbXBSZXN1bHRzIDwtIGNvbXB1dGVBY2MocmFuZG9tVHJlZXMsIHRlc3QsIGluZGV4Q2xhc3MpXG4gIHRlbXBSZXN1bHRzXG59XG5yZXN1bHRzNTAgPC0gZm9yZWFjaChpPTE6MTAsIC5jb21iaW5lPWNiaW5kLCAucGFja2FnZXMgPSAnZGF0YS50cmVlJykgJWRvcGFyJSB7XG4gIHRlc3QgPC0gZm9sZHNbW2ldXVxuICB0cmFpbiA8LSBkby5jYWxsKHJiaW5kLmRhdGEuZnJhbWUsIGZvbGRzWy1pXSlcbiAgblRyZWVzIDwtIDUwXG4gIHJhbmRvbVRyZWVzIDwtIGVuc2VtYmxlKHRyYWluLCBpbmRleENsYXNzLCBuVHJlZXMpXG4gIHRlbXBSZXN1bHRzIDwtIGNvbXB1dGVBY2MocmFuZG9tVHJlZXMsIHRlc3QsIGluZGV4Q2xhc3MpXG4gIHRlbXBSZXN1bHRzXG59XG5yZXN1bHRzMTAwIDwtIGZvcmVhY2goaT0xOjEwLCAuY29tYmluZT1jYmluZCwgLnBhY2thZ2VzID0gJ2RhdGEudHJlZScpICVkb3BhciUge1xuICB0ZXN0IDwtIGZvbGRzW1tpXV1cbiAgdHJhaW4gPC0gZG8uY2FsbChyYmluZC5kYXRhLmZyYW1lLCBmb2xkc1staV0pXG4gIG5UcmVlcyA8LSAxMDBcbiAgcmFuZG9tVHJlZXMgPC0gZW5zZW1ibGUodHJhaW4sIGluZGV4Q2xhc3MsIG5UcmVlcylcbiAgdGVtcFJlc3VsdHMgPC0gY29tcHV0ZUFjYyhyYW5kb21UcmVlcywgdGVzdCwgaW5kZXhDbGFzcylcbiAgdGVtcFJlc3VsdHNcbn1cbnJlc3VsdHMxMjUgPC0gZm9yZWFjaChpPTE6MTAsIC5jb21iaW5lPWNiaW5kLCAucGFja2FnZXMgPSAnZGF0YS50cmVlJykgJWRvcGFyJSB7XG4gIHRlc3QgPC0gZm9sZHNbW2ldXVxuICB0cmFpbiA8LSBkby5jYWxsKHJiaW5kLmRhdGEuZnJhbWUsIGZvbGRzWy1pXSlcbiAgblRyZWVzIDwtIDEyNVxuICByYW5kb21UcmVlcyA8LSBlbnNlbWJsZSh0cmFpbiwgaW5kZXhDbGFzcywgblRyZWVzKVxuICB0ZW1wUmVzdWx0cyA8LSBjb21wdXRlQWNjKHJhbmRvbVRyZWVzLCB0ZXN0LCBpbmRleENsYXNzKVxuICB0ZW1wUmVzdWx0c1xufVxucmVzdWx0czE1MCA8LSBmb3JlYWNoKGk9MToxMCwgLmNvbWJpbmU9Y2JpbmQsIC5wYWNrYWdlcyA9ICdkYXRhLnRyZWUnKSAlZG9wYXIlIHtcbiAgdGVzdCA8LSBmb2xkc1tbaV1dXG4gIHRyYWluIDwtIGRvLmNhbGwocmJpbmQuZGF0YS5mcmFtZSwgZm9sZHNbLWldKVxuICBuVHJlZXMgPC0gMTUwXG4gIHJhbmRvbVRyZWVzIDwtIGVuc2VtYmxlKHRyYWluLCBpbmRleENsYXNzLCBuVHJlZXMpXG4gIHRlbXBSZXN1bHRzIDwtIGNvbXB1dGVBY2MocmFuZG9tVHJlZXMsIHRlc3QsIGluZGV4Q2xhc3MpXG4gIHRlbXBSZXN1bHRzXG59XG53ZGJjUmVzdWx0czEwICA8LSBjKCB3ZGJjUmVzdWx0czEwLCAgcmVzdWx0czEwKVxud2RiY1Jlc3VsdHMyNSAgPC0gYyggd2RiY1Jlc3VsdHMyNSwgIHJlc3VsdHMyNSlcbndkYmNSZXN1bHRzNTAgIDwtIGMoIHdkYmNSZXN1bHRzNTAsICByZXN1bHRzNTApXG53ZGJjUmVzdWx0czEwMCA8LSBjKHdkYmNSZXN1bHRzMTAwLCByZXN1bHRzMTAwKVxud2RiY1Jlc3VsdHMxMjUgPC0gYyh3ZGJjUmVzdWx0czEyNSwgcmVzdWx0czEyNSlcbndkYmNSZXN1bHRzMTUwIDwtIGMod2RiY1Jlc3VsdHMxNTAsIHJlc3VsdHMxNTApXG59XG5gYGAifQ== -->

```r
wdbcResults10  <- vector()
wdbcResults25  <- vector()
wdbcResults50  <- vector()
wdbcResults100 <- vector()
wdbcResults125 <- vector()
wdbcResults150 <- vector()
data <- read.csv("wdbc.csv",header = TRUE,stringsAsFactors = FALSE,sep=",")
data$ID <- NULL
data <- data[,c(2:31,1)]
indexClass <- 31
classes <- unique(data[,indexClass])
for(j in 1:10){
for(i in 1:length(classes)){
  sclass[[i]] <- data[which(data[,indexClass] == classes[i]),]
  idClass[[i]] <- rep(1:10, (nrow(sclass[[i]])/10) + ceiling((nrow(sclass[[i]])%%10)/10))
  if(length(head(idClass[[i]], nrow(sclass[[i]])-length(idClass[[i]]))) > 0 ){
    idClass[[i]] <- head(idClass[[i]], nrow(sclass[[i]])-length(idClass[[i]]))}
    randomClass[[i]] <- sclass[[i]][sample(seq_along(sclass[[i]]), length(sclass[[i]]))]
  folds[[i]] <- vector()
  for(k in 1:length(classes)){
    folds[[i]] <- rbind(folds[[i]], ListClass[[k]][i])
  }
  folds[[i]] <- do.call(rbind, folds[[i]])
}
results10 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  
  nTrees <- 10
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}
results25 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  nTrees <- 25
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}
results50 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  nTrees <- 50
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}
results100 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  nTrees <- 100
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}
results125 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  nTrees <- 125
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}
results150 <- foreach(i=1:10, .combine=cbind, .packages = 'data.tree') %dopar% {
  test <- folds[[i]]
  train <- do.call(rbind.data.frame, folds[-i])
  nTrees <- 150
  randomTrees <- ensemble(train, indexClass, nTrees)
  tempResults <- computeAcc(randomTrees, test, indexClass)
  tempResults
}
wdbcResults10  <- c( wdbcResults10,  results10)
wdbcResults25  <- c( wdbcResults25,  results25)
wdbcResults50  <- c( wdbcResults50,  results50)
wdbcResults100 <- c(wdbcResults100, results100)
wdbcResults125 <- c(wdbcResults125, results125)
wdbcResults150 <- c(wdbcResults150, results150)
}
```

<!-- rnb-source-end -->

<!-- rnb-output-begin eyJkYXRhIjoiV2FybmluZyBpbiBpZiAoaW5oZXJpdHMoeCwgXCJQT1NJWGN0XCIpKSBzdHJ1Y3R1cmUoeiwgY2xhc3MgPSBjbGFzcyh4KSwgdHpvbmUgPSBhdHRyKHgsICA6XG4gIGNsb3NpbmcgdW51c2VkIGNvbm5lY3Rpb24gNyAoPC1sbWxpY2Vuc2VzLndpcDQuYWRvYmUuY29tOjExNTk5KVxuV2FybmluZyBpbiBpZiAoaW5oZXJpdHMoeCwgXCJQT1NJWGN0XCIpKSBzdHJ1Y3R1cmUoeiwgY2xhc3MgPSBjbGFzcyh4KSwgdHpvbmUgPSBhdHRyKHgsICA6XG4gIGNsb3NpbmcgdW51c2VkIGNvbm5lY3Rpb24gNiAoPC1sbWxpY2Vuc2VzLndpcDQuYWRvYmUuY29tOjExNTk5KVxuV2FybmluZyBpbiBpZiAoaW5oZXJpdHMoeCwgXCJQT1NJWGN0XCIpKSBzdHJ1Y3R1cmUoeiwgY2xhc3MgPSBjbGFzcyh4KSwgdHpvbmUgPSBhdHRyKHgsICA6XG4gIGNsb3NpbmcgdW51c2VkIGNvbm5lY3Rpb24gNSAoPC1sbWxpY2Vuc2VzLndpcDQuYWRvYmUuY29tOjExNTk5KVxuV2FybmluZyBpbiBpZiAoaW5oZXJpdHMoeCwgXCJQT1NJWGN0XCIpKSBzdHJ1Y3R1cmUoeiwgY2xhc3MgPSBjbGFzcyh4KSwgdHpvbmUgPSBhdHRyKHgsICA6XG4gIGNsb3NpbmcgdW51c2VkIGNvbm5lY3Rpb24gNCAoPC1sbWxpY2Vuc2VzLndpcDQuYWRvYmUuY29tOjExNTk5KVxuV2FybmluZyBpbiBpZiAoaW5oZXJpdHMoeCwgXCJQT1NJWGN0XCIpKSBzdHJ1Y3R1cmUoeiwgY2xhc3MgPSBjbGFzcyh4KSwgdHpvbmUgPSBhdHRyKHgsICA6XG4gIGNsb3NpbmcgdW51c2VkIGNvbm5lY3Rpb24gMyAoPC1sbWxpY2Vuc2VzLndpcDQuYWRvYmUuY29tOjExNTk5KVxuIn0= -->

```
Warning in if (inherits(x, "POSIXct")) structure(z, class = class(x), tzone = attr(x,  :
  closing unused connection 7 (<-lmlicenses.wip4.adobe.com:11599)
Warning in if (inherits(x, "POSIXct")) structure(z, class = class(x), tzone = attr(x,  :
  closing unused connection 6 (<-lmlicenses.wip4.adobe.com:11599)
Warning in if (inherits(x, "POSIXct")) structure(z, class = class(x), tzone = attr(x,  :
  closing unused connection 5 (<-lmlicenses.wip4.adobe.com:11599)
Warning in if (inherits(x, "POSIXct")) structure(z, class = class(x), tzone = attr(x,  :
  closing unused connection 4 (<-lmlicenses.wip4.adobe.com:11599)
Warning in if (inherits(x, "POSIXct")) structure(z, class = class(x), tzone = attr(x,  :
  closing unused connection 3 (<-lmlicenses.wip4.adobe.com:11599)
```



<!-- rnb-output-end -->

<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuc3RvcENsdXN0ZXIoY2wpXG5gYGAifQ== -->

```r
stopCluster(cl)
```

<!-- rnb-source-end -->

<!-- rnb-chunk-end -->

